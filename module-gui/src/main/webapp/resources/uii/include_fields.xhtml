<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites"
    xmlns:form="http://goobi.io/form"
    >

    <composite:interface>
    </composite:interface>
    <composite:implementation>
        <c:if test="#{item.fieldType=='input'}">
            <form:field
                label="#{msgs[item.label]}"
                help="#{item.helpMessage}"
                required="#{item.required}">
                <h:inputText
                    id="field#{status.index}"
                    value="#{item.value}"
                    styleClass="form-control">
                    <f:ajax
                        execute="@this" />
                </h:inputText>
                <form:message target="field#{status.index}" />
            </form:field>
        </c:if>
        <c:if test="#{item.fieldType=='textarea'}">
            <form:field
                label="#{msgs[item.label]}"
                help="#{item.helpMessage}"
                required="#{item.required}">
                <form:grow-wrap>
                    <h:inputTextarea
                        id="field#{status.index}"
                        value="#{item.value}"
                        styleClass="form-control">
                        <f:ajax
                            execute="@this" />
                    </h:inputTextarea>
                </form:grow-wrap>
                <form:message target="field#{status.index}" />
            </form:field>
        </c:if>
        <c:if test="#{item.fieldType=='dropdown'}">
            <form:field
                label="#{msgs[item.label]}"
                help="#{item.helpMessage}"
                required="#{item.required}">
                <h:selectOneMenu
                    id="field#{status.index}"
                    value="#{item.value}"
                    styleClass="form-select">
                    <f:selectItems
                        value="#{item.selectItemList}"
                        itemValue="#{var.value}"
                        itemLabel="#{msgs[var.label]}"
                        var="val" />
                    <f:ajax
                        event="change"
                        execute="@this"
                        render="@form" />
                </h:selectOneMenu>
                <form:message target="field#{status.index}" />
            </form:field>
        </c:if>
        <c:if test="#{item.fieldType=='combo'}">
            <form:field
                label="#{msgs[item.label]}"
                help="#{item.helpMessage}"
                required="#{item.required}">
                <h:inputText
                    rendered="#{item.fieldType=='input'}"
                    required="#{item.required}"
                    styleClass="form-control form__input"
                    pt:aria-label="#{msgs[item.label]}"
                    value="#{item.value}"
                    validator="#{item.validateField}">
                    <f:ajax
                        event="blur"
                        execute="@this" />
                    <f:passThroughAttribute
                        name="placeholder"
                        value="#{msgs[item.placeholderText]}" />
                </h:inputText>

                <h:inputTextarea
                    rendered="#{item.fieldType=='textarea'}"
                    required="#{item.required}"
                    styleClass="form-control form__input"
                    pt:aria-label="#{msgs[item.label]}"
                    value="#{item.value}"
                    validator="#{item.validateField}">
                    <f:ajax
                        event="blur"
                        execute="@this" />
                    <f:passThroughAttribute
                        name="placeholder"
                        value="#{msgs[item.placeholderText]}" />
                </h:inputTextarea>

                <h:selectOneMenu
                    rendered="#{item.fieldType=='dropdown'}"
                    required="#{item.required}"
                    styleClass="form-select"
                    pt:aria-label="#{msgs[item.label]}"
                    value="#{item.value}"
                    validator="#{item.validateField}">
                    <f:selectItems
                        value="#{item.selectItemList}"
                        itemValue="#{var.value}"
                        itemLabel="#{msgs[var.label]}"
                        var="val" />
                </h:selectOneMenu>

                <c:if test="#{item.fieldType=='combo'}">
                    <div id="combo">
                        <h:selectBooleanCheckbox
                            id="combo1"
                            value="#{item.booleanValue}"
                            validator="#{item.validateField}">
                            <f:ajax
                                render="@form"
                                execute="@this" />
                        </h:selectBooleanCheckbox>
                        <h:selectOneRadio
                            rendered="#{item.booleanValue}"
                            styleClass="select-radio"
                            id="combo2"
                            value="#{item.subValue}"
                            validator="#{item.validateField}">
                            <f:ajax
                                render="@form"
                                execute="@this" />
                            <f:selectItems
                                value="#{item.selectItemList}"
                                itemValue="#{var.value}"
                                itemLabel="#{msgs[var.label]}"
                                var="val" />
                        </h:selectOneRadio>
                    </div>
                </c:if>
                <h:panelGroup
                    layout="block"
                    rendered="#{!item.fieldValid}"
                    styleClass="text-danger validation-message">
                    <h:outputText value="#{item.validationError}" />
                </h:panelGroup>
            </form:field>
        </c:if>
    </composite:implementation>
</ui:composition>
